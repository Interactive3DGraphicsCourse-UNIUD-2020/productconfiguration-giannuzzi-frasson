<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">

  <title>ACME | Rock Chair by Diesel</title>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-xl">
      <a class="navbar-brand" href="#">A.C.M.E.</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07XL"
        aria-controls="navbarsExample07XL" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExample07XL">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Info</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="dropdown07XL" data-toggle="dropdown"
              aria-expanded="false">Products</a>
            <div class="dropdown-menu" aria-labelledby="dropdown07XL">
              <a class="dropdown-item" href="#">Chairs</a>
              <a class="dropdown-item" href="#">Lamps</a>
              <a class="dropdown-item" href="#">Rockets</a>
            </div>
          </li>
        </ul>
        <form class="form-inline my-2 my-md-0">
          <input class="form-control" type="text" placeholder="Search" aria-label="Search">
        </form>
      </div>
    </div>
  </nav>
  <div class="container-fluid">
    <div class="content-wrapper">
      <div class="item-container">
        <div class="container">
          <div class="row">

            <div class="col-md-6">
              <div class="product" id="parent">
                <canvas id="canvass" width="100" height="300"></canvas>
              </div>
            </div>
            <div class="col-md-6">
              <div class="product-title"> <b>Rock Chair</b> | Diesel with Moroso</div>
              <div class="product-desc">by Diesel Creative Team, 2010 Collection, in collaboration with Moroso.
                Rock Chair Inspired by the beautiful geometric structure of crystals and minerals which Nature creates
                in amazingly complex yet perfect formations, the Rock Chair combines the power and distinctive look of
                its sharp edges with the simple, ergonomic functionality of its seat.</div>
              <div class="product-rating"><i class="fa fa-star gold"></i> <i class="fa fa-star gold"></i> <i
                  class="fa fa-star gold"></i> <i class="fa fa-star gold"></i> <i class="fa fa-star-o"></i> </div>
              <hr>
              <div class="product-desc">Rock Chair is avviable in multiple colors and materials:</div>
              <br>
              <div class="product-desc"><b>Legs material:</b></div>
              <form action="">
                <input type="radio" name="legs" value="l-texture" checked="checked"> Wood
                <input type="radio" name="legs" value="l-golden"> Golden
                <input type="radio" name="legs" value="l-plastic"> Plastic
              </form>
              <div class="product-desc"><b>Seat material:</b></div>
              <form action="">
                <input type="radio" name="seat" value="s-texture" checked="checked"> Pillow
                <input type="radio" name="seat" value="s-golden"> Golden
                <input type="radio" name="seat" value="s-plastic"> Plastic
              </form>
              <div class="product-desc"><b>Structure material:</b></div>
              <form action="">
                <input type="radio" name="structure" value="st-texture" checked="checked"> Metal
                <input type="radio" name="structure" value="st-golden"> Golden
                <input type="radio" name="structure" value="st-plastic"> Plastic
              </form>
              <div class="product-desc">You can select which color you prefer for the <b>plastic</b> (only for the
                plastic material):</div> <input class="jscolor {onFineChange:'updateColor(this)'}" value="FF0000">
              <hr>
              <div class="product-price">$ 368.00</div>
              <div class="product-stock">In Stock</div>
              <hr>
              <div class="btn-group cart">
                <button type="button" class="btn btn-success">
                  Add to cart
                </button>
              </div>
              <div class="btn-group wishlist">
                <button type="button" class="btn btn-danger">
                  Add to wishlist
                </button>
              </div>
            </div>
          </div>


        </div>
      </div>
      <div class="container-fluid">
        <div class="col-md-12 product-info">
          <div class="container product-info">
            <h3>DESCRIPTION</h3>
            The Rock Chair has an iconic design made by Moroso in collaboration with the Diesel Creative team for the
            2010 collection. The aspect is unique, the semplicity and mix between curves and hard edges makes the light
            bounching in many different ways.
            Moroso made this possible and A.C.M.E. went even further prototyping and developing the same design in many
            different materials. In the begenning made a new release made all in colored plastic, a shiny PVC that
            permit to the customer to custom theyr purchese.

            <h3>A.C.M.E. Rocket Chair by Moroso features:</h3>
            <li>5 materials avviable for their parts (not all materials are avviable for each parts):<ul>
                <li>Painted metal</li>
                <li>Sintetic Whool</li>
                <li>Golden</li>
                <li>Plastic</li>
                <li>Wood</li>
              </ul>
            </li>
            <li>Stuffed and ultra soft Pillow for the seat</li>
            <li>Ultralight version if take all in PVC
            </li>
            <li>Luxory edition gold plated</li>
          </div>


          <hr>
        </div>
      </div>
    </div>
  </div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="js/jquery-3.4.1.slim.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jscolor.js"></script>

  <script src="libs/three.min.js"></script>
  <script src="libs/stats.min.js"></script>
  <script src="libs/OrbitControls.js"></script>
  <script src="libs/OBJLoader.js"></script>
  <script src='libs/dat.gui.min.js'></script>
  <script src='libs/shaders.js'></script>

  <!-- three.js code -->

  <script>
    var canvass = $('#canvass')[0];
    var parent = $('#parent')[0];
    var renderer = new THREE.WebGLRenderer({ canvas: canvass, antialiasing: true });
    var camera = new THREE.PerspectiveCamera(45, parent.clientWidth / parent.clientHeight, 1, 1000);
    var controls = new THREE.OrbitControls(camera, renderer.domElement);
    var scene = new THREE.Scene();

    //LIGHTS FOR SHADER

    // default: white, 1.0 intensity
    var lightParameters = {
      red: 1.0,
      green: 1.0,
      blue: 1.0,
      intensity: 1.0,
    }

    var ambientLightParameters = {
      red: 0.2,
      green: 0.2,
      blue: 0.2,
      intensity: 1.0,
    }

    //TEXTURE FOR SHADERS
    var textureParametersPaint = {
      material: "Metal_Painted_001",
      repeatS: 1.0,
      repeatT: 1.0,
      normalScale: 1.0,
      displacementScale: 0.0,
    }

    var textureParametersFabric = {
      material: "Fabric_Padded_004_",
      repeatS: 0.4,
      repeatT: 0.4,
      normalScale: 0.0,
      displacementScale: 0.0,
    }

    var textureParametersWood = {
      material: "Wood_007_",
      repeatS: 0.3,
      repeatT: 1.5,
      normalScale: 2.0,
      displacementScale: 0.0,
    }

    //MATERIAL PARAMETER
    // default: gold
    var cspecGOLDEN = {
      red: 1.0,
      green: 0.71,
      blue: 0.29,
      roughness: 0.54
    }

    // default: red plastic
    var materialParametersPlastic= {
      cdiff_red: 0.7,
      cdiff_green: 0.0,
      cdiff_blue: 0.0,
      cspec_red: 0.04,
      cspec_green: 0.04,
      cspec_blue: 0.04,
      roughness: 0.10
    }

    //FUNCTION PER IL CORRETTO CARICAMENTO DELLE TEXTURE
    function loadTexture(file) {
      var texture = new THREE.TextureLoader().load(file, function (texture) {
        texture.minFilter = THREE.LinearMipMapLinearFilter;
        texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
        texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
        texture.offset.set(0, 0);
        texture.needsUpdate = true;
        console.log("PRIMA: " + texture.rotation);
        texture.rotation = (1.55);
        console.log("DOPO: " + texture.rotation);
        render();
      })
      return texture;
    }

    //MAPPE PER LA TEXTURE
    var diffuseMapPaint = loadTexture("textures/diesel/Metal_Painted_001_basecolor.jpg");
    var specularMapPaint = loadTexture("textures/diesel/Metal_Painted_001_roughness.jpg");
    var roughnessMapPaint = loadTexture("textures/diesel/Metal_Painted_001_roughness.jpg");
    var normalMapPaint = loadTexture("textures/diesel/Metal_Painted_001_normal.jpg");
    var aoMapPaint = loadTexture("textures/diesel/Metal_Painted_001_ambientOcclusion.jpg");
    var displacementMapPaint = loadTexture("textures/diesel/Metal_Painted_001_height.png");

    var diffuseMapFabric = loadTexture("textures/diesel/Fabric_Burlap_003_basecolor.jpg");
    var specularMapFabric = loadTexture("textures/diesel/Fabric_Burlap_003_roughness.jpg");
    var roughnessMapFabric = loadTexture("textures/diesel/Fabric_Burlap_003_roughness.jpg");
    var normalMapFabric = loadTexture("textures/diesel/Fabric_Burlap_003_normal.jpg");
    var aoMapFabric = loadTexture("textures/diesel/Fabric_Burlap_003_ambientOcclusion.jpg");
    var displacementMapFabric = loadTexture("textures/diesel/Fabric_Burlap_003_height.png");

    var diffuseMapWood = loadTexture("textures/diesel/Old_Wood_001_COLOR.jpg");
    var specularMapWood = loadTexture("textures/diesel/Old_Wood_001_ROUGH.jpg");
    var roughnessMapWood = loadTexture("textures/diesel/Old_Wood_001_ROUGH.jpg");
    var normalMapWood = loadTexture("textures/diesel/Old_Wood_001_NORM.jpg");
    var aoMapWood = loadTexture("textures/diesel/Old_Wood_001_OCC.jpg");
    var displacementMapWood = loadTexture("textures/diesel/Old_Wood_001_DISP.png");

    //CUBEMAP
    var loader = new THREE.CubeTextureLoader();
    loader.setPath('textures/cubemap2/');
    var textureCube = loader.load([
      'px.png', 'nx.png',
      'py.png', 'ny.png',
      'pz.png', 'nz.png'
    ]);
    
    //CUBO
    var geometry = new THREE.BoxGeometry( 100, 100, 100 );
    var material = new THREE.MeshPhongMaterial( {color: 0xffffff, side: THREE.BackSide} );
    var cube = new THREE.Mesh( geometry, material );
    scene.add( cube );


    //SHADER UNIFORMS
    var uniformsPaint = {
      uniforms: THREE.UniformsUtils.merge([
        THREE.UniformsLib['lights'],
        {
          lightIntensity: { type: 'f', value: 1.0 },
        }
      ]),
      specularMap: { type: "t", value: specularMapPaint },
      diffuseMap: { type: "t", value: diffuseMapPaint },
      roughnessMap: { type: "t", value: roughnessMapPaint },
      normalMap: { type: "t", value: normalMapPaint },
      aoMap: { type: "t", value: aoMapPaint },
      displacementMap: { type: "t", value: displacementMapPaint },
      displacementScale: { type: "f", value: 0.0 },
      normalScale: { type: "v2", value: new THREE.Vector2(1, 1) },
      spotLightPosition: { type: "v3", value: new THREE.Vector3() },
      spotLightPosition1: { type: "v3", value: new THREE.Vector3() },
      spotLightPosition2: { type: "v3", value: new THREE.Vector3() },
      clight: { type: "v3", value: new THREE.Vector3() },
      envMap: { type: "t", value: textureCube },
      ambientLight: { type: "v3", value: new THREE.Vector3() },
      textureRepeat: { type: "v2", value: new THREE.Vector2(1, 1) },
      lights: true,
    };


    var uniformsFabric = {
      uniforms: THREE.UniformsUtils.merge([
        THREE.UniformsLib['lights'],
        {
          lightIntensity: { type: 'f', value: 1.0 },
        }
      ]),
      specularMap: { type: "t", value: specularMapFabric },
      diffuseMap: { type: "t", value: diffuseMapFabric },
      roughnessMap: { type: "t", value: roughnessMapFabric },
      normalMap: { type: "t", value: normalMapFabric },
      aoMap: { type: "t", value: aoMapFabric },
      displacementMap: { type: "t", value: displacementMapFabric },
      displacementScale: { type: "f", value: 0.0 },
      normalScale: { type: "v2", value: new THREE.Vector2(2, 2) },
      spotLightPosition: { type: "v3", value: new THREE.Vector3() },
      spotLightPosition1: { type: "v3", value: new THREE.Vector3() },
      spotLightPosition2: { type: "v3", value: new THREE.Vector3() },
      clight: { type: "v3", value: new THREE.Vector3() },
      envMap: { type: "t", value: textureCube },
      ambientLight: { type: "v3", value: new THREE.Vector3() },
      textureRepeat: { type: "v2", value: new THREE.Vector2(0.3, 0.3) },
      lights: true,
    };

    var uniformsWood = {
      uniforms: THREE.UniformsUtils.merge([
        THREE.UniformsLib['lights'],
        {
          lightIntensity: { type: 'f', value: 1.0 },
        }
      ]),
      specularMap: { type: "t", value: specularMapWood },
      diffuseMap: { type: "t", value: diffuseMapWood },
      roughnessMap: { type: "t", value: roughnessMapWood },
      normalMap: { type: "t", value: normalMapWood },
      aoMap: { type: "t", value: aoMapWood},
      displacementMap: { type: "t", value: displacementMapWood },
      displacementScale: { type: "f", value: 0.0 },
      normalScale: { type: "v2", value: new THREE.Vector2(1, 1) },
      pointLightPosition: { type: "v3", value: new THREE.Vector3() },
      pointLightPosition1: { type: "v3", value: new THREE.Vector3() },
      pointLightPosition2: { type: "v3", value: new THREE.Vector3() },
      clight: { type: "v3", value: new THREE.Vector3() },
      envMap: { type: "t", value: textureCube },
      ambientLight: { type: "v3", value: new THREE.Vector3() },
      textureRepeat: { type: "v2", value: new THREE.Vector2(1, 1) },
      lights: true,
    };

    var uniformsGOLDEN = {
      cspec: { type: "v3", value: new THREE.Vector3() },
      roughness: { type: "f", value: 0.5 },
      pointLightPosition: { type: "v3", value: new THREE.Vector3() },
      pointLightPosition1: { type: "v3", value: new THREE.Vector3() },
      pointLightPosition2: { type: "v3", value: new THREE.Vector3() },
      clight: { type: "v3", value: new THREE.Vector3() },
    };

    var uniformsPlastic = {
      cspec: { type: "v3", value: new THREE.Vector3() },
      cdiff: { type: "v3", value: new THREE.Vector3(1.0, 0.0, 0.0) },
      roughness: { type: "f", value: 0.5 },
      pointLightPosition: { type: "v3", value: new THREE.Vector3() },
      pointLightPosition1: { type: "v3", value: new THREE.Vector3() },
      pointLightPosition2: { type: "v3", value: new THREE.Vector3() },
      clight: { type: "v3", value: new THREE.Vector3() },
    };

    //CODICE DEGLI SHADER PRESENTE IN shader.js
    vs = vertexShader();
    fs = fragmentShader();
    fs1 = fragmentShader1();
    fsGOLDEN = fragmentShaderGOLDEN();
    fsPlastic = fragmentShaderPlastic();

    //PAVIMENTO
    var geo = new THREE.PlaneGeometry(1000, 1000, 100, 100);
    var mat = new THREE.MeshPhongMaterial({ color: 0xffffff });
    var plane = new THREE.Mesh(geo, mat);
    plane.rotateX(- Math.PI / 2);
    scene.add(plane);
    plane.castShadow = false;
    plane.receiveShadow = true;

    //DEFINIZIONE MATERIALE
    var ourMaterialPaint = new THREE.ShaderMaterial({ uniforms: uniformsPaint, vertexShader: vs, fragmentShader: fs });
    ourMaterialPaint.extensions.derivatives = true;

    var ourMaterialFabric = new THREE.ShaderMaterial({ uniforms: uniformsFabric, vertexShader: vs, fragmentShader: fs1 });
    ourMaterialFabric.extensions.derivatives = true;
    var ourMaterialWood = new THREE.ShaderMaterial({ uniforms: uniformsWood, vertexShader: vs, fragmentShader: fs1 });
    ourMaterialWood.extensions.derivatives = true;
    var ourMaterialGOLDEN = new THREE.ShaderMaterial({ uniforms: uniformsGOLDEN, vertexShader: vs, fragmentShader: fsGOLDEN });
    ourMaterialGOLDEN.extensions.derivatives = true;
    var ourMaterialPlastic = new THREE.ShaderMaterial({ uniforms: uniformsPlastic, vertexShader: vs, fragmentShader: fsPlastic });

    //carico oggetto       
    var loader = new THREE.OBJLoader();
    var seduta;
    var struttura;
    var gambe;
    var sedia = new THREE.Object3D()

    loader.load('models/sedia.obj', function (object) {
      //object.envMap = textureCube;				
      gambe = object.children[2];
      struttura = object.children[1];
      seduta = object.children[0];
      seduta.material = ourMaterialFabric;
      struttura.material = ourMaterialPaint;
      gambe.material = ourMaterialWood;

      gambe.castShadow = true;
      struttura.castShadow = true;
      seduta.castShadow = true;
      gambe.receiveShadow = true;
      struttura.receiveShadow = true;
      seduta.receiveShadow = true;

      sedia.add(seduta);
      sedia.add(struttura);
      sedia.add(gambe);
      render();
    });

    var light = new THREE.SpotLight(0xffffff, 0.8, 100, Math.PI / 2, 0.2, 2);//SpotLight( color : Integer, intensity : Float, distance : Float, angle : Radians, penumbra : Float, decay : Float )
    light.position.set(0.0, 25.0, -10.0);
    scene.add(light);

    var light1 = new THREE.SpotLight(0xd1e264, 0.8, 100, Math.PI / 3, 1, 8);
    light1.position.set(22.0, 19.0, -11.0);
    scene.add(light1);


    var light2 = new THREE.SpotLight(0x0f4c81, 0.8, 100, Math.PI / 3, 0.9, 6);
    light2.position.set(-28.0, 15.0, 3.0);
    scene.add(light2);
    
    uniformsPaint.spotLightPosition.value = light.position;
    uniformsPaint.spotLightPosition1.value = light1.position;
    uniformsPaint.spotLightPosition2.value = light2.position;

    uniformsFabric.spotLightPosition.value = light.position;
    uniformsFabric.spotLightPosition1.value = light1.position;
    uniformsFabric.spotLightPosition2.value = light2.position;

    uniformsWood.pointLightPosition.value = light.position;
    uniformsWood.pointLightPosition1.value = light1.position;
    uniformsWood.pointLightPosition2.value = light2.position;

    uniformsGOLDEN.pointLightPosition.value = light.position;
    uniformsGOLDEN.pointLightPosition1.value = light1.position;
    uniformsGOLDEN.pointLightPosition2.value = light2.position;

    uniformsPlastic.pointLightPosition.value = light.position;
    uniformsPlastic.pointLightPosition1.value = light1.position;
    uniformsPlastic.pointLightPosition2.value = light2.position;

    //modifico target delle luci altrimenti punta a (0, 0, 0);
    var targetObject = new THREE.Object3D();
    targetObject.position.x = 2;
    targetObject.position.y = 5;
    targetObject.position.z = 2;
    scene.add(targetObject);
    light1.target = targetObject;

    var targetObject2 = new THREE.Object3D();
    targetObject2.position.x = -3;
    targetObject2.position.y = 4;
    targetObject2.position.z = 2;
    scene.add(targetObject2);
    light2.target = targetObject2;


    var gui;
    var stats = new Stats();


    function init() {

      renderer.setClearColor(0xf0f0f0);

      //shadowmap
      renderer.shadowMap.enabled = true;
      renderer.shadowMap.type = THREE.PCFSoftShadowMap;
      light.castShadow = true;
      light1.castShadow = true;
      light2.castShadow = true;

      light.shadow.mapSize.width = 1024;
      light.shadow.mapSize.height = 1024;
      light1.shadow.mapSize.width = 1024;
      light1.shadow.mapSize.height = 1024;
      light2.shadow.mapSize.width = 1024;
      light2.shadow.mapSize.height = 1024;

      /*
      //debug luci
      var helper = new THREE.CameraHelper( light.shadow.camera );
      scene.add( helper );
      var helper2 = new THREE.CameraHelper( light1.shadow.camera );
      scene.add( helper2 );
      var helper3 = new THREE.CameraHelper( light2.shadow.camera );
      scene.add( helper3 );          
      */


      camera.position.set(-14, 6, 11);
      //camera.lookAt(0,10,0);
      scene.add(camera);
      scene.add(sedia);

      //IMPOSTIAMO QUI LE INFO DELLA CANVAS
      renderer.setPixelRatio(8);
      //renderer.setSize(window.innerWidth, window.innerHeight);

      controls.addEventListener('change', render);
      controls.minDistance = 10;
      controls.maxDistance = 40;
      controls.enablePan = false;
      controls.target.set(0, 5, 0);
      controls.maxPolarAngle = 1.67;
      controls.update();
      window.addEventListener('resize', onResize, false);


      stats.domElement.style.position = 'absolute';
      stats.domElement.style.top = '0px';
      stats.domElement.style.paddingLeft = '10px';
      parent.appendChild(stats.domElement);
    }

    function onResize() {

      renderer.setSize(parent.clientWidth, parent.clientHeight);
      camera.aspect = (parent.clientWidth / parent.clientHeight);
      camera.updateProjectionMatrix();
      render();
    }

    function update() {
      requestAnimationFrame(update);
      stats.update();
    }

    function render() {
      updateUniforms();
      renderer.render(scene, camera);

    }

    function clearGui() {

      if (gui) gui.destroy();
      gui = new dat.GUI();
      gui.open();

    }

    function buildGui() {

      clearGui();
      lightSettings = gui.addFolder('Light Parameters');
      lightSettings.add(lightParameters, 'red').min(0).max(1).onChange(function (newVal) { render() });
      lightSettings.add(lightParameters, 'green').min(0).max(1).onChange(function (newVal) { render() });
      lightSettings.add(lightParameters, 'blue').min(0).max(1).onChange(function (newVal) { render() });
      lightSettings.add(lightParameters, 'intensity').min(0).max(3).onChange(function (newVal) { render() });

      textureSettings = gui.addFolder('Texture parameters Paint');
      textureSettings.add(textureParametersPaint, 'repeatS').min(0.1).max(10).onChange(function (newVal) { render() });
      textureSettings.add(textureParametersPaint, 'repeatT').min(0.1).max(10).onChange(function (newVal) { render() });
      textureSettings.add(textureParametersPaint, 'normalScale').min(-3).max(3).onChange(function (newVal) { render() });
      textureSettings.add(textureParametersPaint, 'displacementScale').min(-3).max(3).onChange(function (newVal) { render() });

      textureSettingsFabric = gui.addFolder('Texture parameters Fabric');
      textureSettingsFabric.add(textureParametersFabric, 'repeatS').min(0.1).max(10).onChange(function (newVal) { render() });
      textureSettingsFabric.add(textureParametersFabric, 'repeatT').min(0.1).max(10).onChange(function (newVal) { render() });
      textureSettingsFabric.add(textureParametersFabric, 'normalScale').min(-3).max(3).onChange(function (newVal) { render() });
      textureSettingsFabric.add(textureParametersFabric, 'displacementScale').min(-3).max(3).onChange(function (newVal) { render() });

      textureSettingsWood = gui.addFolder('Texture parameters Wood');
      textureSettingsWood.add(textureParametersWood, 'repeatS').min(0.1).max(10).onChange(function (newVal) { render() });
      textureSettingsWood.add(textureParametersWood, 'repeatT').min(0.1).max(10).onChange(function (newVal) { render() });
      textureSettingsWood.add(textureParametersWood, 'normalScale').min(-3).max(3).onChange(function (newVal) { render() });
      textureSettingsWood.add(textureParametersWood, 'displacementScale').min(-3).max(3).onChange(function (newVal) { render() });

      //parent.appendChild(gui.domElement);
    }


    function updateUniforms() {
      uniformsPaint.clight.value = new THREE.Vector3(
        lightParameters.red * lightParameters.intensity,
        lightParameters.green * lightParameters.intensity,
        lightParameters.blue * lightParameters.intensity);
      uniformsPaint.ambientLight.value = new THREE.Vector3(
        ambientLightParameters.red * ambientLightParameters.intensity,
        ambientLightParameters.green * ambientLightParameters.intensity,
        ambientLightParameters.blue * ambientLightParameters.intensity
      );
      uniformsPaint.textureRepeat.value = new THREE.Vector2(textureParametersPaint.repeatS, textureParametersPaint.repeatT);
      uniformsPaint.diffuseMap.value = diffuseMapPaint;
      uniformsPaint.specularMap.value = specularMapPaint;
      uniformsPaint.roughnessMap.value = roughnessMapPaint;
      uniformsPaint.normalMap.value = normalMapPaint;
      uniformsPaint.aoMap.value = aoMapPaint;
      uniformsPaint.displacementMap.value = displacementMapPaint;
      uniformsPaint.displacementScale.value = textureParametersPaint.displacementScale;
      uniformsPaint.normalScale.value = new THREE.Vector2(textureParametersPaint.normalScale, textureParametersPaint.normalScale);

      uniformsFabric.clight.value = new THREE.Vector3(
        lightParameters.red * lightParameters.intensity,
        lightParameters.green * lightParameters.intensity,
        lightParameters.blue * lightParameters.intensity);
      uniformsFabric.ambientLight.value = new THREE.Vector3(
        ambientLightParameters.red * ambientLightParameters.intensity,
        ambientLightParameters.green * ambientLightParameters.intensity,
        ambientLightParameters.blue * ambientLightParameters.intensity
      );
      uniformsFabric.textureRepeat.value = new THREE.Vector2(textureParametersFabric.repeatS, textureParametersFabric.repeatT);
      uniformsFabric.diffuseMap.value = diffuseMapFabric;
      uniformsFabric.specularMap.value = specularMapFabric;
      uniformsFabric.roughnessMap.value = roughnessMapFabric;
      uniformsFabric.normalMap.value = normalMapFabric;
      uniformsFabric.aoMap.value = aoMapFabric;
      uniformsFabric.displacementMap.value = displacementMapFabric;
      uniformsFabric.displacementScale.value = textureParametersFabric.displacementScale;
      uniformsFabric.normalScale.value = new THREE.Vector2(textureParametersFabric.normalScale, textureParametersFabric.normalScale);

      uniformsWood.clight.value = new THREE.Vector3(
        lightParameters.red * lightParameters.intensity,
        lightParameters.green * lightParameters.intensity,
        lightParameters.blue * lightParameters.intensity);
      uniformsWood.ambientLight.value = new THREE.Vector3(
        ambientLightParameters.red * ambientLightParameters.intensity,
        ambientLightParameters.green * ambientLightParameters.intensity,
        ambientLightParameters.blue * ambientLightParameters.intensity
      );
      uniformsWood.textureRepeat.value = new THREE.Vector2(textureParametersWood.repeatS, textureParametersWood.repeatT);
      uniformsWood.textureRepeat.value = new THREE.Vector2(textureParametersWood.repeatS, textureParametersWood.repeatT);
      uniformsWood.diffuseMap.value = diffuseMapWood;
      uniformsWood.specularMap.value = specularMapWood;
      uniformsWood.roughnessMap.value = roughnessMapWood;
      uniformsWood.normalMap.value = normalMapWood;
      uniformsWood.aoMap.value = aoMapWood;
      uniformsWood.displacementMap.value = displacementMapWood;
      uniformsWood.displacementScale.value = textureParametersWood.displacementScale;
      uniformsWood.normalScale.value = new THREE.Vector2(textureParametersWood.normalScale, textureParametersWood.normalScale);


      uniformsGOLDEN.cspec.value = new THREE.Vector3(cspecGOLDEN.red, cspecGOLDEN.green, cspecGOLDEN.blue);
      uniformsGOLDEN.roughness.value = cspecGOLDEN.roughness > 0.0 ? cspecGOLDEN.roughness : 0.01;
      uniformsGOLDEN.clight.value = new THREE.Vector3(
        lightParameters.red * lightParameters.intensity,
        lightParameters.green * lightParameters.intensity,
        lightParameters.blue * lightParameters.intensity);

      uniformsPlastic.cspec.value = new THREE.Vector3(materialParametersPlastic.cspec_red,
        materialParametersPlastic.cspec_green, materialParametersPlastic.cspec_blue);

      uniformsPlastic.roughness.value = materialParametersPlastic.roughness > 0.0 ? materialParametersPlastic.roughness : 0.01;
      uniformsPlastic.clight.value = new THREE.Vector3(
        lightParameters.red * lightParameters.intensity,
        lightParameters.green * lightParameters.intensity,
        lightParameters.blue * lightParameters.intensity);
    }



    init();
    buildGui();
    update();
    render();

    function updateColor(picker) {
      /*console.log(Math.round(picker.rgb[0]) + ', ' +
        Math.round(picker.rgb[1]) + ', ' +
        Math.round(picker.rgb[2]));*/

      ourMaterialPlastic.uniforms.cdiff.value = new THREE.Vector3((Math.round(picker.rgb[0])) / 255,
        (Math.round(picker.rgb[1])) / 255,
        (Math.round(picker.rgb[2])) / 255);
      render();
    }

    $(document).ready(function () {
      $('input[type=radio]').click(function () {
        switch (this.value) {
          case "l-texture":
            gambe.material = ourMaterialWood;
            break;
          case "l-plastic":
            gambe.material = ourMaterialPlastic
            break;
          case "l-golden":
            gambe.material = ourMaterialGOLDEN;
            break;
          case "s-texture":
            seduta.material = ourMaterialFabric;
            break;
          case "s-plastic":
            seduta.material = ourMaterialPlastic
            break;
          case "s-golden":
            seduta.material = ourMaterialGOLDEN;
            break;
          case "st-texture":
            struttura.material = ourMaterialPaint;
            break;
          case "st-plastic":
            struttura.material = ourMaterialPlastic
            break;
          case "st-golden":
            struttura.material = ourMaterialGOLDEN;
            break;
          default:
            console.log(this);
            break;
        }
        render();
      });
    });
  </script>
</body>


</html>